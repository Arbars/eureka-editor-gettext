
EUREKA WISH-LIST
================


______________________________________________________________________

  HIGH PRIORITY
______________________________________________________________________


General
-------

+  Preferences window

+  CHECK screen
   -  linedefs without right side
   -  zero-length linedefs
   -  unclosed sectors
   -  can remove unused Vertices, SideDefs and Sectors

+  configurable keys
   (a) will need various contexts: one for each editing mode,
       one for ALL modes ("global"), one for 3D view, one for browser.

       Priorities:
       1. global
       2. Browser (if active)
       3. 3D view (if active)
       4. edit
       5. thing / linedef / sector / vertex / radtrig

   (b) decide if uppercase keys are considered as SHIFT modified
   (c) probably keep menu shortcuts hard-coded

   (d) some functions need a parameter (or two), perhaps handle this
       from user's POV using a choice (e.g. "less|more" or "-1|+1" or so),
       and figure out how to implement calling the function,
       e.g. int CMD_Whatever(int parm1, int parm2)

+  backup system
      e.g. create ~/.eureka/backups/<basename>_###.wad
           where ### is a number higher than any existing backup of that file
      file is created whenever we CTRL-S, or CTRL-E into existing wad
      limit files to a configurable number and size (delete lowest num)

+  decent dialogs: printf-style parameter, make message fit,
   provide words for the buttons (like "Quit Without Saving").
   use fl_choice() code to bootstrap it.



Documentation
-------------

+  a tutorial for the basics



Editing
-------



3D View
-------

+  problem with mid-masked textures (secret in E1M1, cage in E1M9)

+  fix the slime-trails


Browser
-------


______________________________________________________________________

  LOWER PRIORITY
______________________________________________________________________


General
-------

+  Hexen support

+  ENTER key pops up an "operation" menu, which provides all the
   commands that can be done via the keyboard (e.g. flip linedefs)

+  ability to set other themes
   (a) "none", "gtk+", "plastic"  [gui_scheme]
   (b) colors: default, bright, xxx, custom  [gui_color_set]
   (c) font size (HARD!)
   (d) implement OPT_COLOR [done]

+  able to see what exact warnings and errors from node builder

+  on error, ability to save/export current map
   [unless error was in save code]

+  configurable grid colors, 
   IDEA: grid has separate color for 64x64 flat alignment

+  File / Test Map
   +  make filenames absolute
   +  configurable stuff:
      -  directory to 'cd' into
      -  program to invoke
      -  arguments to use (-iwad, -file, -merge, -warp)
   -  support resource wads
   -  make sure the user built the nodes
      (ideally invoke it automatically)

+  ability to view the current logs
   -  probably store last N lines in memory (no debug info)
   ?  if ! isatty(stdout), write logs to ~/.eureka/LOGS.txt


-  config var for default starting mode

-  support DOOMWADPATH for finding iwads (see Chocolate Doom)

-  make sure Load/Export wad filename not already in master_dir

-  grid drawing too slow when small step and zoomed out

-  a check/fix pass for LoadLevel()

-  ability to use an external node builder

-  don't save a map at the _END_ of wad file
   (prefer existing location, or prefer before existing level where
    the name is <, otherwise at beginning).

-  uppercase the level lump name (Level_name global var)

-  LineDef panel: show "lower" etc in unset pics (low contrast)

?  SHIFT + move mouse = keep current highlight

?  a way to slow down fake mouse wheels?

?  nicer way to select map, render a small 2D version of each map
   and present them in a scrolling list.

?  MacOSX:
   (c) handle the -psnXXX argument (see SDL_main.m)
       NOTE: probably needs integrating some of SDL's logic

IDEA: when no pwad given, load RECENT thing  [config item, default off]

IDEA: allow ".ugh" files as resources
      (and perhaps even DDF files)

IDEA: after inserting a new object, allow moving another object
      (i.e. set edit.did_a_move = true).  Perhaps config item.



Documentation
-------------

-  document texture browser (RIGHT click etc)

+  command line arguments page

   --log : specify a log file to store messages
           without this, messages are sent to stdout

   -d --debug : enable debugging messages
                they go to log file if used, otherwise stderr

   -q --quiet : don't send messages to stdout

-  built-in cheat sheet for mouse buttons and common keys

??  config file page
   (a) ~/.eureka/config.cfg
   (b) general syntax
   (c) list of supported vars



Coding
------

-  prefix linedef utilities with 'LD_', sector utilities with 'SEC_' etc...



Editing
-------

+  texture alignment feature

+  a menu for inserting shapes, especially N-sided polygon

+  when dragging a shape next to existing geometry, highlight
   vertices and linedefs which would get merged, and implement
   that merging.

!!  handle self-referencing linedefs in auto create/split sector

+  fix ClosestLine_CastXXX() and OppositeLineDef() to handle
   the case where the casted ray hits a vertex.

   Example: MAP01 back of line #13 hits line #189
            (should hit either #104 or #360)

+  for the "Edit -> Paste" menu, turn the cursor into crosshairs
   and wait until the user selects a spot to paste to.

+  scrollbars for the canvas

+  View / Find
   (use GoToObject for first match, FindNext starts at selected + 1)

   -  VERTEX mode : useful ??
   -  THING mode : match on type (possibly on flags, TID for hexen)
   -  SECTOR mode: match on type / desc / tag / flat
   -  LINEDEF mode: match on type / desc / tag / texture


-  assume texture names beginning with '#' are special

-  View / Toggle skill mode

-  when highlighting a sector, draw the things in the same color as
   the sector is highlighted, but not as bright.  Because many sector
   functions will affect things too -- make it obvious to the user.

-  disallow insert of new linedef if it would overlap or cross
   an existing linedef (or touch an existing vertex).
   [overridden when SHIFT is pressed, but no auto sectoring then]

   THIS --> if new linedef would cross an existing one, then just
            create a new vertex at the intersection point.

            AND: similarly if a new linedef passes through an
                 existing vertex -- create two instead.

   __IDEA__ the 'c' key in linedef mode to fix crossing / overlaps

-  quantization function: prevent linedefs from overlapping / crossing

-  Multi-select : if CTRL is pressed, don't clear selection after drag

-  exchange object numbers

-  some port-specific line/thing flags

?  disconnect sectors : include islands (perhaps with 'D')

?  when moving a sector and the camera is inside it, move camera too

?  fix PointOutsideOfMap() code to handle places where the point
   cannot "see" the surrounding void space.
   
   TraceLineLoop on the linedef to the right, if faces_outward
   then test upto 32 lines (OppositeLineDef) to see if any can
   see the void.

   if geometry is broken : special result.

??  when one vertex of a linedef is moved (and not the other)
    update the X offset on the appropriate side (right side for start,
    left side for end vertex).

?  SHIFT + SPACE = no auto create/split sectors

IDEA: for quantizing a group of objects, try about 9 delta
      positions (x+0, x+step/4, x-step/4 etc...) and choose the
      "best" quantization.

IDEA: merge vertex and linedef modes

IDEA: a config item to make the "simple" grid occur when grid-snapping
      and the "normal" grid occur in FREE mode.



3D View
-------

-  Render3D_Wheel: add 'dx' parameter, use it

-  handle very tall/thin window : letter box with black

-  closed sectors have a see-through gap (gets bigger further away)

+  being able to select stuff to modify:
   - things
   - floors
   - ceilings
   - sidedef uppers and lowers

-  moving up/down with RMB should not disable gravity when change
   is small

-  able to drag things around
   - raise floors?
   - move vertices?
   + shift textures?

-  View/Place Camera command, cursor turns into +

-  rotated sprites

?  make it into a proper widget (occupy same space as Canvas)

?  an info bar:  X  Y  Z  ANG

?  ability to drag the camera (on 2D viewport)

?  slopes

IDEA: a key (or mouse button) to toggle "grab mouse" mode

IDEA: animation mode, render continuously and show any lighting
      effects and animated / scrolling textures and sprites



Browser
-------

+  a "Recently used" category (sorted by time)
   -  remember values in .dat cache

-  a "Used in map" category (sorted by usage)

+  when opened by a click, jump to the texture/thing/etc clicked on

-  persist current width (in .dat cache file)

-  can change the [max] size of the texture/flat previews

-  scroll speed (i.e. linesize) is configurable

-  no-pic mode for textures and flats

-  search box: ',' for AND, '/' for OR



Game / Port Definitions
-----------------------

+  ability to "remove line 271" (etc)

-  game-def setting: view_height

+  finish HacX support -- categorize the textures

+  support Harmony

-  support Chex Quest 1 and 2

-  FreeDOOM: categorize the new textures

-  a new category for BOOM's "property transfer" linetypes


______________________________________________________________________

  MISCELLANEOUS / IDEAS
______________________________________________________________________


CONSOLE IDEA
------------
   toggle on/off with the F4 key
   exists where map/render is (maybe half, above it)
      (maybe translucent background)
   turns off browser (and vice versa)
   have cvars for config items, changeable in console
   quake-like binding, e.g. "bind w swap-flats"
   arguments beginning with '+' get executed as console commands


WAD SEMANTICS
=============

(a) there is always an IWAD (given by -iwad or found somewhere).
    maps are never saved into an IWAD (special command line option to do it)

    ---> global: 'base_wad'

(b) there is _usually_ a PWAD (given by -file).
    it must be modifiable (e.g. not in /usr), CTRL-S saves into it.

    when absent, user cannot File/Save, the File/Export function
    is done instead.

    ---> global: 'edit_wad'

(c) when File/Export is successful, that becomes the new PWAD.
    the existing PWAD goes away (or becomes a resource wad).

(c) user can File/Load another map, but if it's in an uneditable
    wad (especially the IWAD) then the previous PWAD goes away
    (or becomes a resource wad).

(d) File/New Map needs to ask for a map name.
    If there is current PWAD and map already exists, warn user

(e) WISH: File/Manage Wads...

    - shows the IWAD, PWAD, resource wads (full path)
    - can close current PWAD
    - can create a new WAD

(f) BIG WISH: File/Change IWAD
    BIG WISH: File/Change Port


GAME SEMANTICS
==============

Remove the path and extension from the IWAD, and make the result
lowercase, and that is the name of the "game".  There must be a
config file called 'games/xxx.ugh' which defines everything for
that game.


SECTOR INSERT FUNCTIONS
=======================

(a) in an area without any sector, add a NEW sector there
    (ideally copying values from a nearby sector)
    ---> SPACE

    [there cannot be a highlight]
    [if a single sector is selected, copy values from it]
    [if multiple selected sector -- ignore? beep? copy first?]

    AFTER: this sector becomes selected

(b) in an area with sectoring (broken or not), add a NEW sector
    --->  CTRL + SPACE   [the CTRL forces a NEW sector to be made]

    [if a single sector is selected, copy values from it -- overrides highlight]
    [else if a sector is highlighted, copy that]
    [else use logic from (a)]

    AFTER: this sector becomes selected

(c) in an area with broken sectoring, fix the sectoring using the
    currently highlighted one.
    ---> SPACE

    The presence of a highlighted sector is what differentiates
    case (c) from case (a).

    [if sectors are selected -- ignore? beep?]

    this sector DOES NOT get selected  [because it is NOT NEW]

(d) copy properties from an existing sector (selected) to
    the highlighted one.  Beep if invalid selection.
    --> 'c' copy command

    Hmmm, does it make more sense to select the TARGETs and
    copy from the Highlight ??? ---- CONFIG ITEM!

(e) in any area, change sector to an existing one [selected]
    (i.e. grow that existing sector)
    ---> 'm' merge command



PointCanSeeVoid Algorithm
-------------------------

  Basically use an angular occlusion buffer.  Process each linedef
  in the level and update the angle range in the buffer.  When
  finished, any gaps in the buffer means that the point can "see"
  to infinity.


Quantization Function
---------------------

The selection contains the vertices to move (require vertex mode).

Process each vertex in turn, if quantization works then unselect that
vertex, otherwise keep it selected.  After all processed, BEEP if any
vertices remain selected.

Have a selection_c variable for ones already processed, and ones
which moved successfully.

A vertex that is already on the grid trivially succeeds.
Otherwise try the FOUR nearby corners (TWO when the vertex is
sitting on a grid line), checking nearest first.

THE NEW POSITION MUST BE VACANT for the move to succeed.

Also must prevent linedefs from crossing or overlapping.

There may be a need for additional logic to keep the original
orientation of linedefs (horizontal lines stay horizontal,
vertical lines stay vertical, diagonal lines stay diagonal).

However this is difficult to do in practice : perhaps do it by
checking all lines in an initial pass, and mark vertices which
are not allowed to "round up" to a nearby grid spot (vertices on a
horizontal line are not allowed to round up vertically, and vice
versa).



USER CONFIG NEEDED
-------------------

snap_to_grid

default_floor_height
default_ceiling_height
default_lighting

gamma

floor_bump_small   (2)
floor_bump_medium  (16)
floor_bump_large   (64)

render_forward_speed  (16)
render_turn_speed     (16)
render_updown_speed   (16)

map_mousescroll_speed  (16)

paste_reselects  (true)

render_textures  (true)
render_sprites   (true)
render_lighting  (false)

map_highlight_color
map_selection_color
map_high_sel_color

midmask_back_color

islands_get_new_sector  (true)


GAME CONFIG NEEDED
------------------

untex_wall_colors   <low>  <high>
untex_floor_colors  <low>  <high>

error_color  <pixel>

